<!DOCTYPE html>
<html>
<head>
<script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkcC3sY-M7wqMhukQ_MHX96alapahl9yw"></script>
  <$- include('../partials/head') $>
</head>
<body>
  <$- include('../partials/header', {subHeading: 'Welcome', user: false}) $>
  <main>

      <div class="showContainer">

        <div id="mainImage">
            <img class="showImage" src="<$= spot.image_url $>" />
        </div>

        <div class="imageDetails">
          <div id="showDetails">
            <h2><$= spot.title $></h2>
            <br>
            <$= spot.description $>
            <br>
            <$= spot.address $>
            <br>
            <a href="/spots/<$= spot._id $>/downvote" class="like"><span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span></a>
            &nbsp;&nbsp;<span class="like"><$= spot.rating $></span>&nbsp;&nbsp;
            <a href="/spots/<$= spot._id $>/upvote" class="like"><span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span></a>
            <br>
            <$ spot.tags.forEach(function(tag) {$>
            <$= tag.tag_name $>
            <$ }) $>
            <br>
          </div>

          <div class="map" id="map" data-name="<$= spot.title $>"
          data-lat="<$= spot.lat $>" data-lon="<$= spot.lng $>">
          </div>
        </div>
      </div>
  </main>

  <$- include('../partials/scripts') $>
  <script type="text/javascript">
    function initMap(loc, lat,lon)
    {
      var mapProp = {
        center:new google.maps.LatLng(lat,lon),
        zoom:13,
        zoomControl: true,
        scaleControl: true,
        mapTypeId:google.maps.MapTypeId.ROADMAP
      };
      var map = new google.maps.Map(document.getElementById("map"),mapProp);
      var myLatLng = {lat: lat, lng: lon};
      var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: loc
      });
    }

    $(document).ready(function(){
        $("#map").each(function(index){
          initMap($(this).attr("data-name"),
                  parseFloat($(this).attr("data-lat")),
                  parseFloat($(this).attr("data-lon")));
      })
    });
  </script>

</body>
</html>
